<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Open Community Runtime: Data-block management for OCR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open Community Runtime
   &#160;<span id="projectnumber">0.8</span>
   </div>
   <div id="projectbrief">Documentation for the Open Community Runtime (OCR)&#39;s external and internal API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Data-block management for OCR</div>  </div>
</div><!--header-->
<div class="contents">

<p>Data-block management API for OCR.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga831208f9dcaeb2560f93988d29d80141"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga831208f9dcaeb2560f93988d29d80141">DB_PROP_NONE</a>&#160;&#160;&#160;((u16)0x0)</td></tr>
<tr class="separator:ga831208f9dcaeb2560f93988d29d80141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaea245d2b799ff575c1c0b9a8a5e3f53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#gaaea245d2b799ff575c1c0b9a8a5e3f53">DB_PROP_NO_ACQUIRE</a>&#160;&#160;&#160;((u16)0x1)</td></tr>
<tr class="separator:gaaea245d2b799ff575c1c0b9a8a5e3f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8781682157ebe73114af805cc3539a22"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga8781682157ebe73114af805cc3539a22">ocrDbCreate</a> (ocrGuid_t *db, void **addr, u64 len, u16 flags, ocrGuid_t affinity, ocrInDbAllocator_t allocator)</td></tr>
<tr class="memdesc:ga8781682157ebe73114af805cc3539a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request the creation of a data-block.  <a href="#ga8781682157ebe73114af805cc3539a22">More...</a><br/></td></tr>
<tr class="separator:ga8781682157ebe73114af805cc3539a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc80ea5594e5e55a541a1df4c7727821"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#gabc80ea5594e5e55a541a1df4c7727821">ocrDbDestroy</a> (ocrGuid_t db)</td></tr>
<tr class="memdesc:gabc80ea5594e5e55a541a1df4c7727821"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request for the destruction of a data-block.  <a href="#gabc80ea5594e5e55a541a1df4c7727821">More...</a><br/></td></tr>
<tr class="separator:gabc80ea5594e5e55a541a1df4c7727821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ec03c0b0998bdaf9ccc44a06fb05ca0"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga2ec03c0b0998bdaf9ccc44a06fb05ca0">ocrDbRelease</a> (ocrGuid_t db)</td></tr>
<tr class="memdesc:ga2ec03c0b0998bdaf9ccc44a06fb05ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the DB (indicates that the EDT no longer needs to access it)  <a href="#ga2ec03c0b0998bdaf9ccc44a06fb05ca0">More...</a><br/></td></tr>
<tr class="separator:ga2ec03c0b0998bdaf9ccc44a06fb05ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8aa85542741b3f9e81ce1b48ee72b711"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga8aa85542741b3f9e81ce1b48ee72b711">ocrDbMalloc</a> (ocrGuid_t guid, u64 size, void **addr)</td></tr>
<tr class="memdesc:ga8aa85542741b3f9e81ce1b48ee72b711"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory <em>inside</em> a data-block in a way similar to malloc.  <a href="#ga8aa85542741b3f9e81ce1b48ee72b711">More...</a><br/></td></tr>
<tr class="separator:ga8aa85542741b3f9e81ce1b48ee72b711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fdb9d09d5e7875453870e7c52e524ee"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga9fdb9d09d5e7875453870e7c52e524ee">ocrDbMallocOffset</a> (ocrGuid_t guid, u64 size, u64 *offset)</td></tr>
<tr class="memdesc:ga9fdb9d09d5e7875453870e7c52e524ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory <em>inside</em> a data-block in a way similar to malloc.  <a href="#ga9fdb9d09d5e7875453870e7c52e524ee">More...</a><br/></td></tr>
<tr class="separator:ga9fdb9d09d5e7875453870e7c52e524ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41a15d63d118ebae3f13e86284bd929c"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga41a15d63d118ebae3f13e86284bd929c">ocrDbFree</a> (ocrGuid_t guid, void *addr)</td></tr>
<tr class="memdesc:ga41a15d63d118ebae3f13e86284bd929c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees memory allocated through ocrDbMalloc.  <a href="#ga41a15d63d118ebae3f13e86284bd929c">More...</a><br/></td></tr>
<tr class="separator:ga41a15d63d118ebae3f13e86284bd929c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad937f3dca78f1f728b9ab49f48b2da44"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#gad937f3dca78f1f728b9ab49f48b2da44">ocrDbFreeOffset</a> (ocrGuid_t guid, u64 offset)</td></tr>
<tr class="memdesc:gad937f3dca78f1f728b9ab49f48b2da44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees memory allocated through ocrDbMallocOffset.  <a href="#gad937f3dca78f1f728b9ab49f48b2da44">More...</a><br/></td></tr>
<tr class="separator:gad937f3dca78f1f728b9ab49f48b2da44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__OCRDataBlock.html#ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f">ocrDbCopy</a> (ocrGuid_t destination, u64 destinationOffset, ocrGuid_t source, u64 sourceOffset, u64 size, u64 copyType, ocrGuid_t *completionEvt)</td></tr>
<tr class="memdesc:ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies data between two data-blocks in an asynchronous manner.  <a href="#ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f">More...</a><br/></td></tr>
<tr class="separator:ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Data-block management API for OCR. </p>
<p>Describes the data-block API for OCR</p>
<p>Data-blocks are the only form of non-ephemeral storage and are therefore the only way to "share" data between EDTs. Conceptually, data-blocks are contiguous chunks of memory that have a start address and a size. They also have the following characteristics:</p>
<ul>
<li>all memory within the data-block is accessible from the start-address using an offset (ie: addresses [start-address; start-address+size[ uniquely and totally address the entire data-block)</li>
<li>non-overlaping</li>
<li>the pointer to the start of a data-block is only valid between the acquire of the data-block (implicit when the EDT starts) and the corresponding ocrDbRelease call (or the end of the EDT, whichever comes first) </li>
</ul>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gaaea245d2b799ff575c1c0b9a8a5e3f53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_PROP_NO_ACQUIRE&#160;&#160;&#160;((u16)0x1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Property for a data-block indicating that the data-block is just being created but does not need to be acquired at the same time (creation for another EDT) </p>

<p>Definition at line <a class="el" href="ocr-db_8h_source.html#l00044">44</a> of file <a class="el" href="ocr-db_8h_source.html">ocr-db.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga831208f9dcaeb2560f93988d29d80141"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DB_PROP_NONE&#160;&#160;&#160;((u16)0x0)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Property for a data-block indicating no special behavior </p>

<p>Definition at line <a class="el" href="ocr-db_8h_source.html#l00043">43</a> of file <a class="el" href="ocr-db_8h_source.html">ocr-db.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga543adf0a1f8b0c8e6d0cb1ffe9bc4d4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbCopy </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>destinationOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>sourceOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>copyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ocrGuid_t *&#160;</td>
          <td class="paramname"><em>completionEvt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies data between two data-blocks in an asynchronous manner. </p>
<p>This call will trigger the creation of an EDT which will perform a copy from a source data-block into a destination data-block. Once the copy is complete, the event with GUID 'completionEvt'' will be satisfied. That event will carry the destination data-block</p>
<p>The type of GUID passed in as source also determines the starting point of the copy:</p>
<ul>
<li>if it is an event GUID, the EDT will be available to run when that event is satisfied. The data-block carried by that event will be used as the source data-block</li>
<li>if it is a data-block GUID, the EDT is immediately available to run.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">destination</td><td>Data-block to copy to (must already be created and large enough to contain copy) </td></tr>
    <tr><td class="paramname">destinationOffset</td><td>Where to start the copy in the destination (in bytes) </td></tr>
    <tr><td class="paramname">source</td><td>Data-block to copy from </td></tr>
    <tr><td class="paramname">sourceOffset</td><td>Where to start the copy from in the source (in bytes) </td></tr>
    <tr><td class="paramname">size</td><td>How many bytes to copy </td></tr>
    <tr><td class="paramname">copyType</td><td>Reserved </td></tr>
    <tr><td class="paramname">completionEvt</td><td>(Returned) Event that will be satisfied when the copy is successful</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success or the following error codes:<ul>
<li>EINVAL: Invalid values for one of the arguments</li>
<li>EPERM: Overlapping data-blocks</li>
<li>ENOMEM: Destination too small to copy into or source too small to copy from</li>
</ul>
</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>Not supported at this point </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00215">215</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga8781682157ebe73114af805cc3539a22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbCreate </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>affinity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ocrInDbAllocator_t&#160;</td>
          <td class="paramname"><em>allocator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request the creation of a data-block. </p>
<p>On successful creation, the returned memory location will be 8 byte aligned. ocrDbCreate also implicitly acquires the data-block for the calling EDT unless DB_PROP_NO_ACQUIRE is specified</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>On successful creation, contains the GUID for the newly created data-block. Will be NULL if the call fails </td></tr>
    <tr><td class="paramname">addr</td><td>On successful creation, contains the 64 bit address if DB_PROP_NO_ACQUIRE is not specified </td></tr>
    <tr><td class="paramname">len</td><td>Size in bytes of the block to allocate. </td></tr>
    <tr><td class="paramname">flags</td><td>If DB_PROP_NO_ACQUIRE, the DB will be created but not acquired (addr will be NULL). Future use are reserved </td></tr>
    <tr><td class="paramname">affinity</td><td>GUID to indicate the affinity container of this DB. </td></tr>
    <tr><td class="paramname">allocator</td><td>Allocator to use to allocate within the data-block</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a status code on failure and 0 on success. On failure will return one of:<ul>
<li>ENXIO : Affinity is invalid</li>
<li>ENOMEM: allocation failed because of insufficient memory</li>
<li>EINVAL: invalid arguments (flags or something else)</li>
<li>EBUSY : the agent that is needed to process this request is busy. Retry is possible.</li>
<li>EPERM : trying to allocate in an area of memory that is not allowed</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The default allocator (NO_ALLOC) will disallow calls to ocrDbMalloc and ocrDbFree. If an allocator is used, part of the data-block's space will be taken up by the allocator's management overhead </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00031">31</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

<p>References <a class="el" href="ocr-datablock_8h_source.html#l00074">ocrDataBlockFcts_t::acquire</a>, <a class="el" href="ocr-policy-domain_8h_source.html#l00235">ocrPolicyDomain_t::allocateDb</a>, <a class="el" href="ocr-datablock_8h_source.html#l00121">ocrDataBlock_t::fctPtrs</a>, and <a class="el" href="ocr-datablock_8h_source.html#l00112">ocrDataBlock_t::guid</a>.</p>

</div>
</div>
<a class="anchor" id="gabc80ea5594e5e55a541a1df4c7727821"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbDestroy </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request for the destruction of a data-block. </p>
<p>The EDT does not need to have acquired the data-block to destroy it. ocrDbDestroy will request destruction of the DB but the DB will only be destroyed once all other EDTs that have acquired it, release it.</p>
<p>Note that if the EDT has acquired this DB, this call implicitly releases the DB.</p>
<p>Once a DB has been marked as 'to-be-destroyed' by this call, the following operations will result in an error:</p>
<ul>
<li>re-destroying the DB (will return EPERM) The following operations will produce undefined behavior:</li>
<li>accessing the actual location of the DB (through a pointer)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>Used as input to determine the DB to be destroyed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A status code<ul>
<li>0: successful</li>
<li>EPERM: DB cannot be destroyed because it was already destroyed</li>
<li>EINVAL: db does not refer to a valid data-block </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00088">88</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

<p>References <a class="el" href="ocr-datablock_8h_source.html#l00121">ocrDataBlock_t::fctPtrs</a>, and <a class="el" href="ocr-datablock_8h_source.html#l00101">ocrDataBlockFcts_t::free</a>.</p>

</div>
</div>
<a class="anchor" id="ga41a15d63d118ebae3f13e86284bd929c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbFree </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>guid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees memory allocated through ocrDbMalloc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guid</td><td>DB to free from </td></tr>
    <tr><td class="paramname">addr</td><td>Address to free</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The address passed here must have been allocated before the release of the containing data-block. Use ocrDbFreeOffset if allocating and freeing across EDTs for example</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Not supported at this point </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00248">248</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

</div>
</div>
<a class="anchor" id="gad937f3dca78f1f728b9ab49f48b2da44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbFreeOffset </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>guid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees memory allocated through ocrDbMallocOffset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guid</td><td>DB to free from </td></tr>
    <tr><td class="paramname">offset</td><td>Offset to free</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>Not supported at this point </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00252">252</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga8aa85542741b3f9e81ce1b48ee72b711"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbMalloc </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>guid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates memory <em>inside</em> a data-block in a way similar to malloc. </p>
<p>This will allocate a chunk of size 'size' and return its address in 'addr' using the memory available in the data-block</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guid</td><td>DB to malloc from </td></tr>
    <tr><td class="paramname">size</td><td>Size of the chunk to allocate </td></tr>
    <tr><td class="paramname">addr</td><td>Address to the chunk allocated or NULL on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The status of the operation:<ul>
<li>0: successful</li>
<li>ENOMEM: Not enough space to allocate</li>
<li>EINVAL: DB does not support allocation</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The address returned is valid <em>only</em> between the innermost ocrAcquire/ocrRelease pair. Use ocrDbMallocOffset to get a more stable 'pointer'</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Not supported at this point </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00163">163</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9fdb9d09d5e7875453870e7c52e524ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbMallocOffset </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>guid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u64 *&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates memory <em>inside</em> a data-block in a way similar to malloc. </p>
<p>This call is very similar to ocrDbMalloc except that it returns the location of the memory allocated as an <em>offset</em> from the start of the data-block. This is the preferred method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guid</td><td>DB to malloc from </td></tr>
    <tr><td class="paramname">size</td><td>Size of the chunk to allocate </td></tr>
    <tr><td class="paramname">offset</td><td>Offset of the chunk allocated in the data-block</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The status of the operation:<ul>
<li>0: successful</li>
<li>ENOMEM: Not enough space to allocate</li>
<li>EINVAL: DB does not support allocation</li>
</ul>
</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Not supported at this point </dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00167">167</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2ec03c0b0998bdaf9ccc44a06fb05ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 ocrDbRelease </td>
          <td>(</td>
          <td class="paramtype">ocrGuid_t&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release the DB (indicates that the EDT no longer needs to access it) </p>
<p>Call should be used to indicate an early release of the DB (ie: it is not needed in the rest of the EDT). Once the DB is released, pointers that were previously associated with it are invalid and should not be used to access the data.</p>
<p>The functionality of ocrDbRelease is implicitly contained in:</p>
<ul>
<li><a class="el" href="group__OCRDataBlock.html#gabc80ea5594e5e55a541a1df4c7727821" title="Request for the destruction of a data-block.">ocrDbDestroy()</a></li>
<li>EDT exit</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>ocrDbRelease should only be called <em>once</em> at most.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>DB to release</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The status of the operation.<ul>
<li>0: successful</li>
<li>EINVAL: db does not refer to a valid data-block</li>
<li>EACCES: EDT is not registered with the data-block and therefore cannot release it </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="ocr-db_8c_source.html#l00137">137</a> of file <a class="el" href="ocr-db_8c_source.html">ocr-db.c</a>.</p>

<p>References <a class="el" href="ocr-datablock_8h_source.html#l00121">ocrDataBlock_t::fctPtrs</a>, and <a class="el" href="ocr-datablock_8h_source.html#l00087">ocrDataBlockFcts_t::release</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 14 2014 06:13:41 for Open Community Runtime by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
